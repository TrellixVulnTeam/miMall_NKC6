{"remainingRequest":"/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/src/pages/cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/src/pages/cart.vue","mtime":1631865919339},{"path":"/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/manhuax/xmh/2021/Vue全家桶高访小米商城/my code/MiMall-xmh/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBPcmRlckhlYWRlciBmcm9tICIuLy4uL2NvbXBvbmVudHMvT3JkZXJIZWFkZXIiOwppbXBvcnQgU2VydmljZUJhciBmcm9tICIuLy4uL2NvbXBvbmVudHMvU2VydmljZUJhciI7CmltcG9ydCBOYXZGb290ZXIgZnJvbSAiLi8uLi9jb21wb25lbnRzL05hdkZvb3RlciI7CmltcG9ydCBNb2RhbCBmcm9tICIuLy4uL2NvbXBvbmVudHMvTW9kYWwiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBjb21wb25lbnRzOiB7CiAgICBPcmRlckhlYWRlciwKICAgIFNlcnZpY2VCYXIsCiAgICBOYXZGb290ZXIsCiAgICBNb2RhbCwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0OiBbXSwgLy/llYblk4HliJfooagKICAgICAgYWxsQ2hlY2tlZDogZmFsc2UsIC8v5piv5ZCm5YWo6YCJCiAgICAgIGNhcnRUb3RhbFByaWNlOiAwLCAvL+WVhuWTgeaAu+mHkeminQogICAgICBjaGVja2VkTnVtOiAwLCAvL+mAieS4reWVhuWTgeaVsOmHjwogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldENhcnRMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDojrflj5botK3nianovabliJfooagKICAgIGdldENhcnRMaXN0KCkgewogICAgICB0aGlzLmF4aW9zLmdldCgiL2NhcnRzIikudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5yZW5kZXJEYXRhKHJlcyk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOabtOaWsOi0reeJqei9puaVsOmHj+WSjOi0reeJqei9puWNlemAieeKtuaAgQogICAgdXBkYXRlQ2FydChpdGVtLCB0eXBlKSB7CiAgICAgIGxldCBxdWFudGl0eSA9IGl0ZW0ucXVhbnRpdHksCiAgICAgICAgc2VsZWN0ZWQgPSBpdGVtLnByb2R1Y3RTZWxlY3RlZDsKICAgICAgaWYgKHR5cGUgPT0gIi0iKSB7CiAgICAgICAgaWYgKHF1YW50aXR5ID09IDEpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygi5ZWG5ZOB6Iez5bCR5L+d55WZ5LiA5Lu2Iik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC0tcXVhbnRpdHk7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAiKyIpIHsKICAgICAgICBpZiAocXVhbnRpdHkgPiBpdGVtLnByb2R1Y3RTdG9jaykgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCLotK3kubDmlbDph4/kuI3og73otoXov4flupPlrZjmlbDph48iKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgKytxdWFudGl0eTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxlY3RlZCA9ICFpdGVtLnByb2R1Y3RTZWxlY3RlZDsKICAgICAgfQogICAgICB0aGlzLmF4aW9zCiAgICAgICAgLnB1dChgL2NhcnRzLyR7aXRlbS5wcm9kdWN0SWR9YCwgewogICAgICAgICAgcXVhbnRpdHksCiAgICAgICAgICBzZWxlY3RlZCwKICAgICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMucmVuZGVyRGF0YShyZXMpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8vIOWIoOmZpOi0reeJqei9puWVhuWTgQogICAgZGVsUHJvZHVjdChpdGVtKSB7CiAgICAgIHRoaXMuYXhpb3MuZGVsZXRlKGAvY2FydHMvJHtpdGVtLnByb2R1Y3RJZH1gKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWIoOmZpOaIkOWKnyIpOwogICAgICAgIHRoaXMucmVuZGVyRGF0YShyZXMpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmjqfliLblhajpgInlip/og70KICAgIHRvZ2dsZUFsbCgpIHsKICAgICAgbGV0IHVybCA9IHRoaXMuYWxsQ2hlY2tlZCA/ICIvY2FydHMvdW5TZWxlY3RBbGwiIDogIi9jYXJ0cy9zZWxlY3RBbGwiOwogICAgICB0aGlzLmF4aW9zLnB1dCh1cmwpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMucmVuZGVyRGF0YShyZXMpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDlhazlhbHotYvlgLwKICAgIHJlbmRlckRhdGEocmVzKSB7CiAgICAgIHRoaXMubGlzdCA9IHJlcy5jYXJ0UHJvZHVjdFZvTGlzdCB8fCBbXTsKICAgICAgdGhpcy5hbGxDaGVja2VkID0gcmVzLnNlbGVjdGVkQWxsOwogICAgICB0aGlzLmNhcnRUb3RhbFByaWNlID0gcmVzLmNhcnRUb3RhbFByaWNlOwogICAgICB0aGlzLmNoZWNrZWROdW0gPSB0aGlzLmxpc3QuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnByb2R1Y3RTZWxlY3RlZCkubGVuZ3RoOwogICAgfSwKICAgIC8vIOi0reeJqei9puS4i+WNlQogICAgb3JkZXIoKSB7CiAgICAgIGxldCBpc0NoZWNrID0gdGhpcy5saXN0LmV2ZXJ5KChpdGVtKSA9PiAhaXRlbS5wcm9kdWN0U2VsZWN0ZWQpOwogICAgICBpZiAoaXNDaGVjaykgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygi6K+36YCJ5oup5LiA5Lu25ZWG5ZOBIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9vcmRlci9jb25maXJtIik7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cart.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div class=\"cart\">\n    <order-header title=\"我的购物车\">\n      <template v-slot:tip>\n        <span>温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算</span>\n      </template>\n    </order-header>\n    <div class=\"wrapper\">\n      <div class=\"container\">\n        <div class=\"cart-box\">\n          <ul class=\"cart-item-head\">\n            <li class=\"col-1\">\n              <span\n                class=\"checkbox\"\n                v-bind:class=\"{ checked: allChecked }\"\n                @click=\"toggleAll\"\n              ></span>\n              全选\n            </li>\n            <li class=\"col-3\">商品名称</li>\n            <li class=\"col-1\">单价</li>\n            <li class=\"col-2\">数量</li>\n            <li class=\"col-1\">小计</li>\n            <li class=\"col-1\">操作</li>\n          </ul>\n          <ul class=\"cart-item-list\">\n            <li\n              class=\"cart-item\"\n              v-for=\"(item, index) in list\"\n              v-bind:key=\"index\"\n            >\n              <div class=\"item-check\">\n                <span\n                  class=\"checkbox\"\n                  v-bind:class=\"{ checked: item.productSelected }\"\n                  @click=\"updateCart(item)\"\n                ></span>\n              </div>\n              <div class=\"item-name\">\n                <img v-lazy=\"item.productMainImage\" alt=\"\" />\n                <span>\n                  {{ item.productName + \" , \" + item.productSubtitle }}\n                </span>\n              </div>\n              <div class=\"item-price\">{{ item.productPrice }}</div>\n              <div class=\"item-num\">\n                <div class=\"num-box\">\n                  <a href=\"javascript:;\" @click=\"updateCart(item, '-')\">-</a>\n                  <span>{{ item.quantity }}</span>\n                  <a href=\"javascript:;\" @click=\"updateCart(item, '+')\">+</a>\n                </div>\n              </div>\n              <div class=\"item-total\">{{ item.productTotalPrice }}</div>\n              <div class=\"item-del\" @click=\"delProduct(item)\"></div>\n            </li>\n          </ul>\n        </div>\n        <div class=\"order-wrap clearfix\">\n          <div class=\"cart-tip fl\">\n            <a href=\"/#/index\">继续购物</a>\n            共\n            <span>{{ list.length }}</span>\n            件商品，已选择\n            <span>{{ checkedNum }}</span>\n            件\n          </div>\n          <div class=\"total fr\">\n            合计：\n            <span>{{ cartTotalPrice }}</span>\n            元\n            <a href=\"javascript:;\" class=\"btn\" @click=\"order\">去结算</a>\n          </div>\n        </div>\n      </div>\n    </div>\n    <service-bar></service-bar>\n    <nav-footer></nav-footer>\n  </div>\n</template>\n<script>\nimport OrderHeader from \"./../components/OrderHeader\";\nimport ServiceBar from \"./../components/ServiceBar\";\nimport NavFooter from \"./../components/NavFooter\";\nimport Modal from \"./../components/Modal\";\nexport default {\n  name: \"index\",\n  components: {\n    OrderHeader,\n    ServiceBar,\n    NavFooter,\n    Modal,\n  },\n  data() {\n    return {\n      list: [], //商品列表\n      allChecked: false, //是否全选\n      cartTotalPrice: 0, //商品总金额\n      checkedNum: 0, //选中商品数量\n    };\n  },\n  mounted() {\n    this.getCartList();\n  },\n  methods: {\n    // 获取购物车列表\n    getCartList() {\n      this.axios.get(\"/carts\").then((res) => {\n        this.renderData(res);\n      });\n    },\n    // 更新购物车数量和购物车单选状态\n    updateCart(item, type) {\n      let quantity = item.quantity,\n        selected = item.productSelected;\n      if (type == \"-\") {\n        if (quantity == 1) {\n          this.$message.warning(\"商品至少保留一件\");\n          return;\n        }\n        --quantity;\n      } else if (type == \"+\") {\n        if (quantity > item.productStock) {\n          this.$message.warning(\"购买数量不能超过库存数量\");\n          return;\n        }\n        ++quantity;\n      } else {\n        selected = !item.productSelected;\n      }\n      this.axios\n        .put(`/carts/${item.productId}`, {\n          quantity,\n          selected,\n        })\n        .then((res) => {\n          this.renderData(res);\n        });\n    },\n    // 删除购物车商品\n    delProduct(item) {\n      this.axios.delete(`/carts/${item.productId}`).then((res) => {\n        this.$message.success(\"删除成功\");\n        this.renderData(res);\n      });\n    },\n    // 控制全选功能\n    toggleAll() {\n      let url = this.allChecked ? \"/carts/unSelectAll\" : \"/carts/selectAll\";\n      this.axios.put(url).then((res) => {\n        this.renderData(res);\n      });\n    },\n    // 公共赋值\n    renderData(res) {\n      this.list = res.cartProductVoList || [];\n      this.allChecked = res.selectedAll;\n      this.cartTotalPrice = res.cartTotalPrice;\n      this.checkedNum = this.list.filter((item) => item.productSelected).length;\n    },\n    // 购物车下单\n    order() {\n      let isCheck = this.list.every((item) => !item.productSelected);\n      if (isCheck) {\n        this.$message.warning(\"请选择一件商品\");\n      } else {\n        this.$router.push(\"/order/confirm\");\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.cart {\n  .wrapper {\n    background-color: #f5f5f5;\n    padding-top: 30px;\n    padding-bottom: 114px;\n    .cart-box {\n      background-color: #fff;\n      font-size: 14px;\n      color: #999999;\n      text-align: center;\n      .checkbox {\n        display: inline-block;\n        width: 22px;\n        height: 22px;\n        border: 1px solid #e5e5e5;\n        vertical-align: middle;\n        margin-right: 17px;\n        cursor: pointer;\n        &.checked {\n          background: url(\"/imgs/icon-gou.png\") #ff6600 no-repeat center;\n          background-size: 16px 12px;\n          border: none;\n        }\n      }\n      .cart-item-head {\n        display: flex;\n        height: 79px;\n        line-height: 79px;\n        .col-1 {\n          flex: 1;\n        }\n        .col-2 {\n          flex: 2;\n        }\n        .col-3 {\n          flex: 3;\n        }\n      }\n      .cart-item-list {\n        .cart-item {\n          display: flex;\n          align-items: center;\n          height: 125px;\n          border-top: 1px solid #e5e5e5;\n          font-size: 16px;\n          .item-check {\n            flex: 1;\n          }\n          .item-name {\n            flex: 3;\n            font-size: 18px;\n            color: #333333;\n            display: flex;\n            align-items: center;\n            img {\n              width: 80px;\n              height: 80px;\n              vertical-align: middle;\n            }\n            span {\n              margin-left: 30px;\n            }\n          }\n          .item-price {\n            flex: 1;\n            color: #333333;\n          }\n          .item-num {\n            flex: 2;\n            .num-box {\n              display: inline-block;\n              width: 150px;\n              height: 40px;\n              line-height: 40px;\n              border: 1px solid #e5e5e5;\n              font-size: 14px;\n              a {\n                display: inline-block;\n                width: 50px;\n                color: #333333;\n              }\n              span {\n                display: inline-block;\n                width: 50px;\n                color: #333333;\n              }\n            }\n          }\n          .item-total {\n            flex: 1;\n            color: #ff6600;\n          }\n          .item-del {\n            flex: 1;\n            width: 14px;\n            height: 12px;\n            background: url(\"/imgs/icon-close.png\") no-repeat center;\n            background-size: contain;\n            cursor: pointer;\n          }\n        }\n      }\n    }\n    .order-wrap {\n      font-size: 14px;\n      color: #666666;\n      margin-top: 20px;\n      height: 50px;\n      line-height: 50px;\n      .cart-tip {\n        margin-left: 29px;\n        a {\n          color: #666666;\n          margin-right: 37px;\n        }\n        span {\n          color: #ff6600;\n          margin: 0 5px;\n        }\n      }\n      .total {\n        font-size: 14px;\n        color: #ff6600;\n        span {\n          font-size: 24px;\n        }\n        a {\n          width: 202px;\n          height: 50px;\n          line-height: 50px;\n          font-size: 18px;\n          margin-left: 37px;\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}